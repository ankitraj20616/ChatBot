# ChatBot
# LLM-Powered Chatbot with FastAPI & PostgreSQL

This project is a **backend-focused implementation** of an **LLM-powered chatbot** using **FastAPI**, **PostgreSQL**, and a **Groq-hosted Large Language Model (LLM)** such as **Llama 3.1** or **Mistral-7B**.  

The system accepts **natural language queries**, converts them into **SQL using the LLM**, executes the query on a **PostgreSQL database**, and returns the results to the user.

Instead of a React frontend, **Postman-based API testing instructions** are provided.

---

## Features

- Natural Language → SQL conversion using **Groq LLM**
- Secure **FastAPI Backend**
- **PostgreSQL** database integration
- Dynamic SQL execution from user queries
- **Token-based Authentication (JWT)**
- Logging of:
  - User queries
  - Generated SQL queries
  - Execution errors
- Error handling for:
  - Invalid queries
  - SQL execution failures
  - Unauthorized access
- Environment variable support using **`.env`**
- Postman API testing instructions

---

## Tech Stack

| Component | Technology |
|----------|------------|
| Backend | FastAPI (Python) |
| Database | PostgreSQL |
| LLM | Groq (Llama 3.1 / Mistral-7B) |
| Security | JWT Authentication |
| API Testing | Postman |
| ORM | SQLAlchemy |

---

## Database Schema

The project uses a **customer database** with the following schema:

```sql
CREATE TABLE customers (
    customer_id SERIAL PRIMARY KEY,
    name TEXT NOT NULL,
    gender TEXT NOT NULL,
    location TEXT NOT NULL
);
```
## Create a .env file in the backend root directory with the following:
# Groq
GROQ_API_KEY="YOUR_GROQ_API_KEY"

# JWT
JWT_SECRET_KEY="YOUR_JWT_SECRET_KEY"
JWT_ALGORITHM="YOUR_JWT_ALGORITHM"
ACCESS_TOKEN_EXPIRE_MINUTES=60

# Databases
1. AUTH_DATABASE_URL="YOUR_AUTH_DATABASE_URL" , like:- "postgresql://postgres:db_password@localhost:5432/Chatbot_Auth"
2.CHATBOT_DATABASE_URL="YOUR_CHATBOT_DATABASE_URL", like:- "postgresql://postgres:db_password@localhost:5432/Chatbot_Chat"

## Ports
AUTH_SERVICE_PORT=8001
CHATBOT_SERVICE_PORT=8002


## How to Run the Project
1. Clone the Repository:-
     git clone https://github.com/your-username/your-repo-name.git](https://github.com/ankitraj20616/ChatBot.git
     cd ChatBot
2. Create & Activate Virtual Environment:-
   pipenv install
   pipenv shell
3. Install Dependencies
   pipenv install
4. Setup PostgreSQL Databases:-
   CREATE DATABASE Chatbot_Auth;
   CREATE DATABASE Chatbot_Chat;
   Ensure credentials match the .env file.
5. Seed the Customer Database:-
   python chatbot_service/seed_customers.py
   This inserts 5+ customer records.
6. Start the Microservices:-
   Auth Service (Port 8001):- uvicorn auth_service.main:app --reload --port 8001
   Chatbot Service (Port 8002):- uvicorn chatbot_service.main:app --reload --port 8002

## API Testing Using Postman
1. Register User (Auth Service):-
- POST
http://localhost:8001/register

Body (JSON):
{
  "username": "ankit",
  "password": "123456"
}

2. Login User:-
- POST
http://localhost:8001/login

Body (JSON):
{
  "username": "ankit",
  "password": "123456"
}

Response:
{
  "access_token": "eyJhbGciOiJIUzI1NiIsInR...",
  "token_type": "bearer"
}
Copy this token for protected API calls.

3. Ask the Chatbot (Main Feature):-
- POST
http://localhost:8002/chat/query

Headers:
Authorization: Bearer YOUR_ACCESS_TOKEN
Content-Type: application/json

Body (JSON):
{
  "query": "Show me all female customers from Mumbai"
}

Sample Response
{
  "sql": "SELECT customer_id, name, gender, location FROM customers WHERE gender = 'female' AND location = 'Mumbai';",
  "rows": [
    {
      "customer_id": 1,
      "name": "Aisha Khan",
      "gender": "female",
      "location": "Mumbai"
    },
    {
      "customer_id": 3,
      "name": "Neha Patel",
      "gender": "female",
      "location": "Mumbai"
    }
  ]
}


## Confirms:
- LLM converted English → SQL
- SQL executed on PostgreSQL
- Data returned successfully

## Sample Test Queries:
- Show all customers from Delhi
- List all female customers
- Show male customers from Bangalore
- Show all customers

## Logging

The project logs:
- User queries
- SQL generated by the LLM
- SQL execution errors
- Authentication failures

## Error Handling

Handled cases:
- Invalid SQL from LLM
- Database connection failure
- Unauthorized access
- Token expiry
- Empty result sets

## Notes

- Backend-focused AI + database project
- No frontend UI used
- Postman provided as frontend substitute
- Secured using JWT
- LLM restricted to safe SELECT queries only

## Author

Ankit Raj
Backend Developer
GitHub: https://github.com/ankitraj20616
